const artigos = [
    {
        title: "QUEM SÃO OS GOLFINHOS?",
        body: `<figure><img src="img/tucuxi-salto.webp" alt="Imagem de um tucuxi saltando na água." class="images">
        <figcaption>Tucuxi (<i>Sotalia fluviatilis</i>) © Axel Antoine via iNaturalist, licenciada sob CC BY-NC 4.0</figcaption></figure>
        <p>Antes de tudo, é importante esclarecer o uso da palavra "golfinhos". Esse é um termo popular e genérico usado para se referir aos animais do grupo dos <b>odontocetos</b>. Embora seja válido, nem sempre é o mais preciso do ponto de vista científico. Em geral, esse termo nos remete àqueles golfinhos marinhos de cor acinzentada e de médio porte, que vivem saltando na água e são altamente sociáveis. No entanto, os "golfinhos" são muito mais diversos que isso!</p>
        <p>Então, quem são esses odontocetos? Os odontocetos, junto com os <b>misticetos</b> (as baleias), formam um grupo maior chamado <b>cetáceos</b>. Os cetáceos são mamíferos carnívoros que passam toda a vida em ambiente aquático e possuem um par de nadadeiras peitorais e uma nadadeira caudal disposta na horizontal. É essa proximidade entre odontocetos e misticetos que fazem com que seus representantes sejam frequentemente confundidos entre os grupos, especialmente quando apresentam um porte diferente do esperado. No entanto, os odontocetos apresentam algumas características que não são encontradas nos misticetos, como a presença de dentes na boca e apenas um orifício respiratório no topo da cabeça, além de utilizarem um sistema de ecolocalização para se orientar no ambiente.</p>
        <p>Atualmente, são reconhecidas cerca de 79 espécies de odontocetos. Entre os representantes mais lembrados desse grupo, estão o <span class="clickable-word" data-image="img/nariz-garrafa.webp" data-credits="Foto: Golfinho-nariz-de-garrafa (Tursiops truncatus) © Rafi Amar via iNaturalist, licenciada sob CC BY-NC 4.0">golfinho-bico-de-garrafa</span>, o <span class="clickable-word" data-image="img/boto-cinza-salto.webp" data-credits="Foto: Boto-cinza (Sotalia guianensis) © Jakob Fahr via iNaturalist, licenciada sob CC BY-NC 4.0">boto-cinza</span>, o <span class="clickable-word" data-image="img/cachalote.webp" data-credits="Foto: Cachalote (Physeter macrocephalus) © Stas Zakharov via iNaturalist, licenciada sob CC BY-NC 4.0">cachalote</span>, a <span class="clickable-word" data-image="img/orca-salto.webp" data-credits="Foto: Orca (Orcinus orca) © Sherry Kirkvold via iNaturalist, licenciada sob CC BY-NC 4.0">orca</span>, a <span class="clickable-word" data-image="img/toninha-foto.webp" data-credits="Foto: Toninha (Pontoporia blainvillei) © Yaku Pacha, licenciada sob CC BY-NC 4.0">toninha</span>, o <span class="clickable-word" data-image="img/narval.webp" data-credits="Foto: Narval (Monodon monoceros) © Fonte desconhecida">narval</span> e a <span class="clickable-word" data-image="img/belugas.webp" data-credits="Foto: Beluga (Delphinapterus leucas) © Wikipedia">beluga</span> (sim, orca e cachalote não são baleias!). Note que esses ainda são todos "golfinhos", mas carregam nomes populares próprios que ajudam a diferenciá-los, evitando confusões e ambiguidades na comunicação não científica. Ainda assim, os nomes populares variam entre regiões e culturas. Por exemplo, a espécie <i>Inia geoffrensis</i> é conhecida nacionalmente como boto-cor-de-rosa, mas é chamada de boto-vermelho em algumas comunidades da Amazônia.</p>
        <p>No próximo tópico, falaremos sobre as principais características presentes no corpo de um odontoceto, pontuando, sempre que possível, as diferenças entre eles e as baleias (misticetos), a fim de esclarecer melhor a delimitação entre os dois grupos.</p>`
    },
    {
        title: "PRINCIPAIS CARACTERÍSTICAS!",
        body: `<figure><img src="img/anatomy.webp" alt="Imagem didática da anatomia de um golfinho." class="images">
        <figcaption>Morfologia do golfinho-nariz-de-garrafa (<i>Tursiops truncatus</i>) © 2020 Roundhouse Aquarium.</figcaption></figure>
        <p>Ao longo de um período de milhões de anos de evolução, os odontocetos desenvolveram adaptações incríveis para a vida integral no ambiente aquático. Essas adaptações incluem modificações na morfologia que permitiram que esses animais aprimorassem um desempenho na locomoção, caça e comunicação muito eficientes, que os fizeram ótimos predadores!</p>
        <h3>FORMA GERAL</h3>
        <p>No geral, os odontocetos possuem um corpo fusiforme e hidrodinâmico, sem pelos e escamas, perfeito para quebrar a resistência e reduzir o atrito com a água, permitindo uma movimentação veloz. A coloração geralmente segue um padrão básico de contraste, onde o dorso (a parte de cima) tende a ser mais escuro que o ventre (a parte de baixo), gerando uma camuflagem com o fundo escuro das águas e a claridade da superfície banhada pela luz solar. Divergindo ou não desse padrão, os odontocetos se apresentam em uma grande variação de cores entre as espécies, podendo conter mesclas de diferentes tons de preto, branco, cinza, <span class="clickable-word" data-image="img/golfinho-comum.webp" data-credits="Foto: Golfinho-comum-de-bico-curto (Delphinus delphis) com o padrão básico de contraste e as laterais mescladas com amarelo. © Alexandre Roux via flickr, licenciada sob CC BY-NC 2.0.">amarelo</span>, marrom e até rosa.</p>
        <h3>CABEÇA</h3>
        <p>A maioria dos odontocetos exibem um <b>rostro</b> bem definido, uma estrutura formada pela maxila e mandíbula (ossos que delimitam a parte superior e inferior, respectivamente, da boca) e que se projeta na extremidade anterior da cabeça e carrega os <span class="clickable-word" data-image="img/nariz-garrafa-dentes.webp" data-credits="Foto: Golfinho-nariz-de-garrafa (Tursiops truncatus) exibindo os dentes.">dentes</span>. Esses <b>dentes</b> podem ser utilizados tanto para apreender o alimento, quanto para desempenhar interações sociais. Ao contrário dos odontocetos, a boca das baleias não carregam dentes, mas sim placas de <span class="clickable-word" data-image="img/barbatanas.webp" data-credits="Foto: Boca de uma baleia-cinzenta (Eschrichtius robustus) com as placas de barbatana. © Christopher Swann/Minden Pictures">barbatanas</span>, utilizadas exclusivamente para filtrar o alimento.</p>
        <p>Uma característica exclusiva dos odontocetos e que pode ser bem marcante, como na beluga, é o <span class="clickable-word" data-image="img/belugatrump.webp" data-credits="Tradução: 'O que ela está pensando?'">melão</span>. O <b>melão</b> é uma estrutura de tecido gorduroso localizada na testa desses animais, bem à frente do espiráculo. Ele é fundamental para o mecanismo de <b>ecolocalização</b>, atuando como uma "antena" que concentra as sondas sonoras produzidas por esses animais e as direciona para o meio aquático. Desse modo, os odontocetos são capazes de perceber tamanho, forma e distância de uma presa, predador, parceiro ou de obstáculos físicos.</p>
        <p>Um terceiro atributo encontrado na cabeça, citado há pouco, é o <b>espiráculo</b>. Esse é um orifício respiratório que conecta o pulmão à atmosfera, permitindo que os cetáceos expelem o ar usado e absorvam o ar atmosférico rico em oxigênio. <span class="clickable-word" data-image="img/espiraculos.webp" data-credits="Foto: Diferença nos espiráculos dos odontocetos (esquerda) e misticetos (direita).">Odontocetos possuem apenas um desses espiráculos, enquanto os misticetos possuem dois.</span></p>
        <figure><img src="img/rotador.webp" alt="Ilustração de um golfinh-rotador." class="images">
        <figcaption>Ilustração de um golfinho-rotador (<i>Stenella longirostris</i>) © National Oceanic and Atmospheric Administration.</figcaption></figure>
        <h3>NADADEIRAS</h3>
        <p>O plano corpóreo básico de um golfinho inclui <span class="clickable-word" data-image="img/np.webp" data-credits="Foto: Círculo destaca as nadadeiras peitorais.">duas nadadeiras peitorais</span> e <span class="clickable-word" data-image="img/nc.webp" data-credits="Foto: Círculo destaca a nadadeira caudal com dois lóbulos.">uma nadadeira caudal</span> com dois lóbulos, disposta na horizontal (ao contrário dos <span class="clickable-word" data-image="img/fin.jpg" data-credits="Foto: Nadadeira caudal de tubarão via iStock">peixes</span>, cuja nadadeira é vertical). Diferentemente dos misticetos, os odontocetos também podem portar uma <span class="clickable-word" data-image="img/nd.webp" data-credits="Foto: Círculo destaca a nadadeira dorsal.">nadadeira dorsal</span>, o que geralmente é o caso. É importante explicitar que o termo "barbatana", como visto anteriormente, refere-se a uma estrutura localizada na boca das baleias para filtrar o alimento. Portanto, o nome correto para se referir a esses apêndices locomotores, presentes também em peixes (incluindo tubarões, raias e quimeras), é sempre nadadeira!</p>
        <p>As nadadeiras peitorais são as únicas com esqueleto ósseo interno e estão dispostas uma de cada lado do corpo. Elas são usadas principalmente durante o nado para mudar a direção e manter o equilíbrio corporal. Já a nadadeira caudal é conectada ao corpo pelo <span class="clickable-word" data-image="img/p.webp" data-credits="Foto: Seta destaca o pedúnculo caudal.">pedúnculo caudal</span>, uma estrutura formada por feixes musculares resistentes que permitem a propulsão dos odontocetos em movimentos verticais (para cima e para baixo). Por fim, a nadadeira dorsal (ausente em belugas, narvais, <span class="clickable-word" data-image="img/golfinho-liso.webp" data-credits="Foto: Golfinho-liso-do-norte (Lissodelphis borealis). © Robin Gwen Agarwal via iNaturalist, licenciada sob CC BY-NC 4.0">golfinhos-lisos</span> e <span class="clickable-word" data-image="img/marsopa.webp" data-credits="Foto: Marsopa-sem-nadadeira-dorsal-do-Yangtze (Neophocaena asiaeorientalis). © Alex Kantorovich">marsopas-sem-nadadeira-dorsal</span>) é altamente vascularizada e desempenha um importante papel nos mecanismos de dissipação do calor interno e também no equilíbrio.</p>`
    },
    {
        title: "DISTRIBUIÇÃO E HABITAT!",
        body: `<figure><img src="img/map.webp" class="images">
        <figcaption>Mapa do mundo.</figcaption></figure>
        <p>Os odontocetos estão distribuídos por todo o planeta, habitando uma grande variedade de ambientes aquáticos. Eles são encontrados das águas frias das regiões polares até os rios tropicais da da Amazônia!</p>
        <p>Como vimos no tópico anterior, ao longo de milhões de anos de evolução, esses animais desenvolveram adaptações morfológicas, fisiológicas e comportamentais que os tornaram adaptados à vida no ambiente aquático. Porém, essas adaptações não são idênticas entre todas as espécies, pois foram selecionadas conforme os desafios específicos dos diferentes habitats, como variações de temperatura, salinidade, profundidade e disponibilidade de nutrientes. Essas diferenças permitem que cada grupo sobreviva, cresça e se reproduza com sucesso em ambientes distintos.</p>
        <p>Algumas espécies preferem ambientes costeiros e neríticos, próximos às margens dos continentes, onde as águas alcançam até cerca dos 200 metros de profundidade e são ricas em nutrientes e incidência solar. Exemplos desse grupo incluem os golfinhos-nariz-de-garrafa (<i>Tursiops truncatus</i>) e os golfinhos-pintados (<i>Stenella frontalis</i>).</p>
        <p>Outras espécies, por sua vez, especializaram-se em viver em ambientes oceânicos, caracterizados por uma menor disponibilidade de nutrientes e maiores profundidades, também conhecidos como mar aberto. Nesses locais, é comum encontrar cachalotes (<i>Physeter macrocephalus</i>) e baleias-bicudas (Família Ziphiidae), que realizam mergulhos profundos em busca de lulas e outros animais, alcançando até os 2 e 3 mil metros de profundidade, respectivamente.</p>
        <p>Há ainda odontocetos que vivem exclusivamente em rios, como o <span class="clickable-word" data-image="img/botorosa.webp" data-credits="Foto: Boto-cor-de-rosa (Inia geoffrensis). © Paulo Paixão via iNaturalist, licenciada sob CC BY-NC 4.0">boto-cor-de-rosa</span> (<i>Inia geoffrensis</i>) e tucuxi (<i>Sotalia fluviatilis</i>), além dos <span class="clickable-word" data-image="img/golfinhogandes.webp" data-credits="Foto: Golfinho-do-rio-Ganges (Platanista gangetica). © Munshi Md. Abul Barakat via iNaturalist, licenciada sob CC BY-NC 4.0">golfinho-do-rio-Ganges</span> (<i>Platanista gangetica</i>) e <span class="clickable-word" data-image="img/rio-indo.webp" data-credits="Foto: Golfinho-do-rio-Indo (Platanista minor). © Braulik via WWF-Pakistan">golfinho-do-rio-Indo</span> (<i>Platanista minor</i>), encontrados no sul da Ásia. Estes geralmente portam olhos reduzidos e exibem mecanismos de ecolocalização aprimorados, devido a baixa visibilidade em águas turvas.</p>
        <figure><img src="img/climate-800-min.webp" class="images">
        <figcaption>Mapa da temperatura da superfície do mar, mostrando águas mais quentes entre os trópicos e águas mais frias ao se aproximar dos polos.</figcaption></figure>
        <p>Já a temperatura está intimamente associada às zonas climáticas da Terra. Algumas espécies são típicas de águas tropicais e subtropicais, caracterizadas por serem mais quentes e apresentarem pouca variação de temperatura ao longo do ano. Inclui-se nesse grupo o boto-cinza (<i>Sotalia guianensis</i>), cuja distribuição é restrita às regiões costeiras da América do Sul e América Central.</p>
        <p>Por outro lado, há espécies adaptadas às águas frias e mais salinas das zonas polares e subpolares, como a beluga (Delphinapterus leucas) e o narval (Monodon monoceros). Adaptações marcantes nesses animais inclui a ausência da nadadeira dorsal, considerada uma vantagem para navegar sob ou entre as calota polares, e uma camada espessa de gordura (o bubbler) que ajuda a conservar melhor o calor interno.</p>
        <p>Embora muitas espécies de odontocetos tenham preferência por habitats específicos ou certas regiões climáticas, vale destacar que algumas espécies são cosmopolitas! Ou seja, você pode encontrá-las em todos os grandes oceanos do mundo, dos polos aos trópicos, como a orca (<i>Orcinus orca</i>). Além disso, uma mesma espécie pode ter populações vivendo em ambientes bem diferentes: algumas ficam nas águas costeiras, enquanto que outras preferem o mar aberto. Isso ocorre com o <span class="clickable-word" data-image="img/golfinho-rotador.webp" data-credits="Foto: Golfinho-rotador (Stenella longirostris). © Chi-Hsuan Shao via iNaturalist, licenciada sob CC BY-NC 4.0">golfinho-rotador</span> (<i>Stenella longirostris</i>), por exemplo. No fim, tudo isso se relaciona ao nicho ecológico das espécies e de seus indivíduos. O nicho ecológico vai além do espaço físico que um animal ocupa (o habitat), compreendendo a faixa de condições ambientais que ele é capaz de tolerar (como temperatura, salinidade, profundidade, luminosidade e dinâmica das correntes oceânicas, entre outros), além da disponibilidade de recursos alimentares (presas) e das interações ecológicas (como a presença de predadores e competidores). É dentro desses limites ecológicos que a espécie ou indivíduo consegue manter um desempenho biológico mínimo necessário para sobreviver, crescer e se reproduzir.</p>.`
    },
    {
        title: "DIETA E ALIMENTAÇÃO",
        body: `<p><img src="img/6UGKSTIGBTGUGXG5RZMFC3QZQKROB23F.gif" class="construcao"><img src="img/6UGKSTIGBTGUGXG5RZMFC3QZQKROB23F.gif" class="construcao"><img src="img/6UGKSTIGBTGUGXG5RZMFC3QZQKROB23F.gif" class="construcao"><img src="img/6UGKSTIGBTGUGXG5RZMFC3QZQKROB23F.gif" class="construcao"><img src="img/6UGKSTIGBTGUGXG5RZMFC3QZQKROB23F.gif" class="construcao"><img src="img/6UGKSTIGBTGUGXG5RZMFC3QZQKROB23F.gif" class="construcao"><img src="img/6UGKSTIGBTGUGXG5RZMFC3QZQKROB23F.gif" class="construcao"><img src="img/6UGKSTIGBTGUGXG5RZMFC3QZQKROB23F.gif" class="construcao"><img src="img/6UGKSTIGBTGUGXG5RZMFC3QZQKROB23F.gif" class="construcao"><img src="img/6UGKSTIGBTGUGXG5RZMFC3QZQKROB23F.gif" class="construcao"></p>`
    }
];

let artigoAtual = 0;

function exibirArtigo(index) {
    const h2 = document.querySelector('#text-card h2');
    const bodyDiv = document.getElementById('conteudo-body');
    if (artigos[index]) {
        h2.textContent = artigos[index].title;
        bodyDiv.innerHTML = artigos[index].body;
        artigoAtual = index;
        initializeClickableWords();
    }

    document.querySelectorAll('#topicos-menu a').forEach((el, i) => {
        if (i === index) {
            el.classList.add('active');
        } else {
            el.classList.remove('active');
        }
    });
}

function initializeClickableWords() {
    document.querySelectorAll('.clickable-word').forEach(word => {
        word.replaceWith(word.cloneNode(true));
    });

    if (window.imageModal) {
        window.imageModal.initClickableWords();
    }
}

document.addEventListener('DOMContentLoaded', function() {
    exibirArtigo(artigoAtual);

    document.getElementById('botao-proximo').addEventListener('click', function() {
        let prox = artigoAtual + 1;
        if (prox >= artigos.length) prox = 0;
        exibirArtigo(prox);
    });

    document.querySelectorAll('#topicos-menu a').forEach((el, idx) => {
        el.addEventListener('click', function(e) {
            e.preventDefault();
            exibirArtigo(idx);
        });
    });
});

class ImageModal {
    constructor() {
        this.modal = document.getElementById('modalOverlay');
        this.modalWindow = document.getElementById('modalWindow');
        this.modalImage = document.getElementById('modalImage');
        this.modalCredits = document.getElementById('modalCredits');
        this.closeBtn = document.getElementById('closeBtn');
        this.modalHeader = document.getElementById('modalHeader');
        this.isDragging = false;
        this.dragOffset = { x: 0, y: 0 };
        this.init();
    }

    init() {
        this.initClickableWords();
        this.closeBtn.addEventListener('click', () => this.closeModal());
        this.modal.addEventListener('click', (e) => {
            if (e.target === this.modal) {
                this.closeModal();
            }
        });
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && this.modal.style.display === 'block') {
                this.closeModal();
            }
        });
        this.modalHeader.addEventListener('mousedown', (e) => this.startDrag(e));
        document.addEventListener('mousemove', (e) => this.drag(e));
        document.addEventListener('mouseup', () => this.stopDrag());
    }

    initClickableWords() {
        document.querySelectorAll('.clickable-word').forEach(word => {
            word.addEventListener('click', (e) => {
                const imageSrc = e.target.getAttribute('data-image');
                const imageCredits = e.target.getAttribute('data-credits') || '';
                this.openModal(imageSrc, imageCredits);
            });
        });
    }

    openModal(imageSrc, credits = '') {
        this.modalImage.onload = () => {
            const img = this.modalImage;
            const aspectRatio = img.naturalWidth / img.naturalHeight;
            const headerHeight = 40;
            const creditsHeight = credits && credits.trim() !== '' ? 35 : 0;
            const totalExtraHeight = headerHeight + creditsHeight;
            const maxWidth = window.innerWidth * 0.95;
            const maxHeight = (window.innerHeight * 0.95) - totalExtraHeight;
            let width, height;
            if (img.naturalWidth > maxWidth || img.naturalHeight > maxHeight) {
                if (aspectRatio > 1) {
                    width = Math.min(img.naturalWidth, maxWidth);
                    height = width / aspectRatio;
                    if (height > maxHeight) {
                        height = maxHeight;
                        width = height * aspectRatio;
                    }
                } else {
                    height = Math.min(img.naturalHeight, maxHeight);
                    width = height * aspectRatio;
                    if (width > maxWidth) {
                        width = maxWidth;
                        height = width / aspectRatio;
                    }
                }
            } else {
                width = img.naturalWidth;
                height = img.naturalHeight;
            }
            this.modalWindow.style.width = width + 'px';
            this.modalWindow.style.height = (height + totalExtraHeight) + 'px';
            this.modalWindow.style.left = `${(window.innerWidth - width) / 2}px`;
            this.modalWindow.style.top = `${(window.innerHeight - (height + totalExtraHeight)) / 2}px`;
            this.updateCredits(credits);
            this.modal.style.display = 'block';
        };
        this.modalImage.src = imageSrc;
    }

    updateCredits(credits) {
        if (this.modalCredits) {
            if (credits && credits.trim() !== '') {
                this.modalCredits.textContent = credits;
                this.modalCredits.style.display = 'flex';
            } else {
                this.modalCredits.textContent = '';
                this.modalCredits.style.display = 'none';
            }
        }
    }

    closeModal() {
        this.modal.style.display = 'none';
    }

    startDrag(e) {
        this.isDragging = true;
        const rect = this.modalWindow.getBoundingClientRect();
        this.dragOffset.x = e.clientX - rect.left;
        this.dragOffset.y = e.clientY - rect.top;
        this.modalWindow.style.cursor = 'grabbing';
    }

    drag(e) {
        if (!this.isDragging) return;
        e.preventDefault();
        const x = e.clientX - this.dragOffset.x;
        const y = e.clientY - this.dragOffset.y;
        const windowRect = this.modalWindow.getBoundingClientRect();
        const maxX = window.innerWidth - windowRect.width;
        const maxY = window.innerHeight - windowRect.height;
        const constrainedX = Math.max(0, Math.min(x, maxX));
        const constrainedY = Math.max(0, Math.min(y, maxY));
        this.modalWindow.style.left = constrainedX + 'px';
        this.modalWindow.style.top = constrainedY + 'px';
    }

    stopDrag() {
        this.isDragging = false;
        this.modalWindow.style.cursor = 'move';
    }
}

document.addEventListener('DOMContentLoaded', () => {
    window.imageModal = new ImageModal();
});